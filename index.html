<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="format-detection" content="telephone=no"/>
    <title>我的设备</title>
    <link href="./bootstrap.min.css" rel="stylesheet">
    <script src="./jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var access_token = getParameterByName('access_token');

            $("#console").append("access_token:" + access_token + "</br>");
            var deviceLists = getParameterByName('device_list');
            $("#console").append("deviceLists:" + deviceLists + "</br>");

            $("#btnDevice").on('click', function () {
                alert('click');
/*                var data = [{
                    alias: "",
                    bssid: "c89346918374",
                    created: "2015-09-10 17:09:25",
                    id: "b7884af8/c89346918374",
                    ip: "202.241.180.36:2254",
                    offline_time: "2015-09-10 17:34:58",
                    online: "0",
                    online_time: "2015-09-10 17:11:24",
                    power_time: null,
                    serial: null,
                    ssid: null
                }];
                $.each(data, function (i, _data) {
                    $("#console").append(JSON.stringify(_data));
                });*/
                $.ajax({
                    type: "POST",
                    url: 'http://api.easylink.io/v1/device/devices',
                    //dataType: "json",
                    headers: {
                        'AUTHORIZATION': "token " + access_token
                    },
                    success: function (data) {
                        console.log(data);
                        $.each(data, function (i, _data) {
                            $("#console").append(JSON.stringify(_data));
                        });
                    },
                    error: function (data) {
                        console.log(data);
                        $("#console").append(data.responseText);
                    }
                });
            });
        });
        function getParameterByName(name) {
            var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
            return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
        }

    </script>
</head>
<body>
<button id="btnDevice" type="button" class="btn btn-default btn-block">获取设备列表</button>
<div id="console">

</div>

<a href="http://97256c69-6723-43fb-87dc-167eaf9dc501.app.easylink.io/redirect.php?wxappid=wxb4ee08c8823d1555&airkiss=1"
   class="btn btn-info btn-block" role="button" style="bottom:0px; position: fixed;">
    添加设备
</a>
</body>
</html>
